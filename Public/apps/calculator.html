<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AKADEMIA Compact</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
            width: 320px;
            height: 480px;
            overflow: hidden;
            position: relative;
        }

        /* Ultra Compact Container */
        .calculator-container {
            width: 100%;
            height: 100%;
            padding: 12px;
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* Minimal Header */
        .calc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            height: 28px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .logo i {
            font-size: 16px;
            color: #2980b9;
        }

        .logo-text {
            font-size: 14px;
            font-weight: 600;
            color: #2980b9;
            letter-spacing: -0.3px;
        }

        .theme-toggle {
            background: rgba(52, 152, 219, 0.1);
            border: none;
            color: #3498db;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }

        /* Ultra Compact Display */
        .display-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
            border: 1px solid rgba(52, 152, 219, 0.1);
            height: 90px;
        }

        .current-operation {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 6px;
            min-height: 18px;
            word-break: break-all;
            text-align: right;
            font-weight: 400;
        }

        .result {
            font-size: 32px;
            font-weight: 300;
            line-height: 1;
            margin-bottom: 4px;
            word-break: break-all;
            text-align: right;
            color: #2c3e50;
            font-family: 'SF Mono', 'Menlo', monospace;
            min-height: 38px;
        }

        .memory-indicator {
            font-size: 11px;
            color: #3498db;
            display: flex;
            justify-content: space-between;
            padding-top: 8px;
            border-top: 1px solid rgba(52, 152, 219, 0.1);
        }

        /* Memory Buttons - Minimal */
        .memory-row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin-bottom: 12px;
        }

        .memory-btn {
            height: 28px;
            font-size: 12px;
            border-radius: 4px;
            background: rgba(52, 152, 219, 0.08);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.1);
            cursor: pointer;
            font-weight: 500;
        }

        /* Ultra Compact Keypad with Square Buttons */
        .keypad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
            height: 240px;
        }

        .key {
            height: 48px;
            border: none;
            border-radius: 0;
            font-size: 18px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.1s ease;
            user-select: none;
            -webkit-user-select: none;
        }

        /* Button Color Schemes */
        .light-blue {
            background: #e8f4fc;
            color: #2980b9;
            border: 1px solid rgba(52, 152, 219, 0.1);
        }

        .light-blue:hover {
            background: #d6eaf8;
        }

        .medium-blue {
            background: #3498db;
            color: white;
            border: 1px solid #2980b9;
        }

        .medium-blue:hover {
            background: #2980b9;
        }

        .dark-blue {
            background: #1a5276;
            color: white;
            border: 1px solid #154360;
        }

        .dark-blue:hover {
            background: #154360;
        }

        .accent-blue {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: 1px solid #2980b9;
        }

        .accent-blue:hover {
            background: linear-gradient(135deg, #2980b9, #1a5276);
        }

        .white {
            background: #ffffff;
            color: #2c3e50;
            border: 1px solid rgba(52, 152, 219, 0.1);
            font-weight: 500;
        }

        .white:hover {
            background: #f8f9fa;
        }

        /* Zero button spans 2 columns */
        .key.zero {
            grid-column: span 2;
            justify-content: flex-start;
            padding-left: 20px;
        }

        /* Icon buttons */
        .icon-btn {
            font-size: 14px;
        }

        /* Dark mode */
        body.dark-mode {
            background: #1a1a2e;
            color: #ecf0f1;
        }

        body.dark-mode .calculator-container {
            background: #1a1a2e;
        }

        body.dark-mode .display-container {
            background: #2c3e50;
            border: 1px solid rgba(52, 152, 219, 0.2);
        }

        body.dark-mode .current-operation {
            color: #bdc3c7;
        }

        body.dark-mode .result {
            color: #ecf0f1;
        }

        body.dark-mode .memory-indicator {
            color: #3498db;
            border-top: 1px solid rgba(52, 152, 219, 0.2);
        }

        body.dark-mode .white {
            background: #2c3e50;
            color: #ecf0f1;
            border: 1px solid rgba(52, 152, 219, 0.2);
        }

        body.dark-mode .white:hover {
            background: #34495e;
        }

        body.dark-mode .light-blue {
            background: #2c3e50;
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.2);
        }

        body.dark-mode .light-blue:hover {
            background: #34495e;
        }

        body.dark-mode .memory-btn {
            background: rgba(52, 152, 219, 0.15);
            border: 1px solid rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        /* Key press animation */
        .key.pressed {
            transform: scale(0.95);
        }

        /* Focus outline */
        .key:focus {
            outline: 2px solid #3498db;
            outline-offset: 1px;
        }

        /* Footer removed - using all space for calculator */
    </style>
</head>
<body>
    <!-- Calculator Container - Exactly 320x480 -->
    <div class="calculator-container">
        <!-- Minimal Header -->
        <div class="calc-header">
            <div class="logo">
                <i class="fas fa-calculator"></i>
                <div class="logo-text">AKADEMIA</div>
            </div>
            <button class="theme-toggle" id="theme-toggle">
                <i class="fas fa-moon" id="theme-icon"></i>
            </button>
        </div>

        <!-- Display -->
        <div class="display-container">
            <div class="current-operation" id="current-operation"></div>
            <div class="result" id="result">0</div>
            <div class="memory-indicator">
                <span id="memory-status">M: 0</span>
                <span id="angle-mode">DEG</span>
            </div>
        </div>

        <!-- Memory Buttons -->
        <div class="memory-row">
            <button class="memory-btn" data-action="memory-clear">MC</button>
            <button class="memory-btn" data-action="memory-recall">MR</button>
            <button class="memory-btn" data-action="memory-add">M+</button>
            <button class="memory-btn" data-action="memory-subtract">M-</button>
            <button class="memory-btn" data-action="memory-store">MS</button>
        </div>

        <!-- Keypad -->
        <div class="keypad">
            <!-- Row 1 -->
            <button class="key light-blue" data-action="clear" id="clear-btn">
                <span id="clear-text">AC</span>
            </button>
            <button class="key light-blue" data-action="sign">
                <i class="fas fa-plus-minus icon-btn"></i>
            </button>
            <button class="key light-blue" data-action="percentage">
                <i class="fas fa-percent icon-btn"></i>
            </button>
            <button class="key accent-blue" data-action="divide">
                <i class="fas fa-divide icon-btn"></i>
            </button>

            <!-- Row 2 -->
            <button class="key white" data-number="7">7</button>
            <button class="key white" data-number="8">8</button>
            <button class="key white" data-number="9">9</button>
            <button class="key accent-blue" data-action="multiply">
                <i class="fas fa-times icon-btn"></i>
            </button>

            <!-- Row 3 -->
            <button class="key white" data-number="4">4</button>
            <button class="key white" data-number="5">5</button>
            <button class="key white" data-number="6">6</button>
            <button class="key accent-blue" data-action="subtract">
                <i class="fas fa-minus icon-btn"></i>
            </button>

            <!-- Row 4 -->
            <button class="key white" data-number="1">1</button>
            <button class="key white" data-number="2">2</button>
            <button class="key white" data-number="3">3</button>
            <button class="key accent-blue" data-action="add">
                <i class="fas fa-plus icon-btn"></i>
            </button>

            <!-- Row 5 -->
            <button class="key white zero" data-number="0">0</button>
            <button class="key white" data-action="decimal">.</button>
            <button class="key dark-blue" data-action="equals">
                <i class="fas fa-equals icon-btn"></i>
            </button>
        </div>
    </div>

    <script>
        // Calculator state
        const calculator = {
            displayValue: '0',
            firstOperand: null,
            waitingForSecondOperand: false,
            operator: null,
            currentOperation: '',
            memoryValue: 0,
            isClearButton: true,
            isDarkMode: false
        };

        // DOM Elements
        const resultElement = document.getElementById('result');
        const currentOperationElement = document.getElementById('current-operation');
        const clearTextElement = document.getElementById('clear-text');
        const memoryStatusElement = document.getElementById('memory-status');
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');

        // Update display
        function updateDisplay() {
            resultElement.textContent = calculator.displayValue;
            currentOperationElement.textContent = calculator.currentOperation;
            
            // Update clear button text
            if (calculator.isClearButton) {
                clearTextElement.textContent = 'AC';
            } else {
                clearTextElement.textContent = 'C';
            }
            
            // Update memory status
            memoryStatusElement.textContent = `M: ${calculator.memoryValue}`;
        }

        // Input digit
        function inputDigit(digit) {
            const { displayValue, waitingForSecondOperand } = calculator;
            
            if (waitingForSecondOperand) {
                calculator.displayValue = digit;
                calculator.waitingForSecondOperand = false;
                calculator.isClearButton = false;
            } else {
                calculator.displayValue = displayValue === '0' ? digit : displayValue + digit;
                calculator.isClearButton = false;
            }
            
            updateDisplay();
        }

        // Input decimal
        function inputDecimal() {
            if (calculator.waitingForSecondOperand) {
                calculator.displayValue = '0.';
                calculator.waitingForSecondOperand = false;
                calculator.isClearButton = false;
                updateDisplay();
                return;
            }
            
            if (!calculator.displayValue.includes('.')) {
                calculator.displayValue += '.';
                calculator.isClearButton = false;
                updateDisplay();
            }
        }

        // Handle operator
        function handleOperator(nextOperator) {
            const inputValue = parseFloat(calculator.displayValue);
            
            if (calculator.operator && calculator.waitingForSecondOperand) {
                calculator.operator = nextOperator;
                calculator.currentOperation = calculator.currentOperation.slice(0, -1) + getOperatorSymbol(nextOperator);
                updateDisplay();
                return;
            }
            
            if (calculator.firstOperand === null) {
                calculator.firstOperand = inputValue;
            } else if (calculator.operator) {
                const result = performCalculation();
                calculator.displayValue = `${parseFloat(result.toFixed(8))}`;
                calculator.firstOperand = result;
            }
            
            calculator.waitingForSecondOperand = true;
            calculator.operator = nextOperator;
            calculator.currentOperation = `${calculator.displayValue} ${getOperatorSymbol(nextOperator)}`;
            calculator.isClearButton = true;
            
            updateDisplay();
        }

        // Get operator symbol
        function getOperatorSymbol(operator) {
            const symbols = {
                'add': '+',
                'subtract': '−',
                'multiply': '×',
                'divide': '÷'
            };
            return symbols[operator] || operator;
        }

        // Perform calculation
        function performCalculation() {
            const { firstOperand, displayValue, operator } = calculator;
            const inputValue = parseFloat(displayValue);
            
            if (operator === 'add') return firstOperand + inputValue;
            if (operator === 'subtract') return firstOperand - inputValue;
            if (operator === 'multiply') return firstOperand * inputValue;
            if (operator === 'divide') {
                if (inputValue === 0) {
                    return 'Error';
                }
                return firstOperand / inputValue;
            }
            
            return inputValue;
        }

        // Handle equals
        function handleEquals() {
            const inputValue = parseFloat(calculator.displayValue);
            
            if (calculator.operator === null || calculator.firstOperand === null) {
                return;
            }
            
            const result = performCalculation();
            
            if (result === 'Error') {
                calculator.displayValue = 'Error';
                calculator.firstOperand = null;
                calculator.waitingForSecondOperand = false;
                calculator.operator = null;
                calculator.currentOperation = '';
                calculator.isClearButton = true;
            } else {
                calculator.displayValue = `${parseFloat(result.toFixed(8))}`;
                calculator.currentOperation += ` ${inputValue} =`;
                calculator.firstOperand = null;
                calculator.waitingForSecondOperand = false;
                calculator.operator = null;
                calculator.isClearButton = true;
            }
            
            updateDisplay();
        }

        // Clear or clear entry
        function handleClear() {
            if (calculator.isClearButton) {
                // AC - All Clear
                calculator.displayValue = '0';
                calculator.firstOperand = null;
                calculator.waitingForSecondOperand = false;
                calculator.operator = null;
                calculator.currentOperation = '';
                calculator.isClearButton = true;
            } else {
                // C - Clear Entry
                calculator.displayValue = '0';
                calculator.isClearButton = true;
            }
            
            updateDisplay();
        }

        // Handle percentage
        function handlePercentage() {
            const currentValue = parseFloat(calculator.displayValue);
            calculator.displayValue = (currentValue / 100).toString();
            calculator.currentOperation = `${currentValue}%`;
            calculator.isClearButton = false;
            updateDisplay();
        }

        // Toggle sign
        function toggleSign() {
            if (calculator.displayValue !== '0') {
                calculator.displayValue = String(-parseFloat(calculator.displayValue));
                calculator.isClearButton = false;
                updateDisplay();
            }
        }

        // Handle memory functions
        function handleMemory(action) {
            const currentValue = parseFloat(calculator.displayValue);
            
            switch(action) {
                case 'memory-clear':
                    calculator.memoryValue = 0;
                    break;
                case 'memory-recall':
                    calculator.displayValue = calculator.memoryValue.toString();
                    break;
                case 'memory-add':
                    calculator.memoryValue += currentValue;
                    break;
                case 'memory-subtract':
                    calculator.memoryValue -= currentValue;
                    break;
                case 'memory-store':
                    calculator.memoryValue = currentValue;
                    break;
            }
            
            updateDisplay();
        }

        // Toggle theme
        function toggleTheme() {
            calculator.isDarkMode = !calculator.isDarkMode;
            document.body.classList.toggle('dark-mode', calculator.isDarkMode);
            
            if (calculator.isDarkMode) {
                themeIcon.className = 'fas fa-sun';
            } else {
                themeIcon.className = 'fas fa-moon';
            }
        }

        // Handle button click
        function handleButtonClick(event) {
            const button = event.target.closest('button');
            if (!button) return;
            
            // Add press animation
            button.classList.add('pressed');
            setTimeout(() => {
                button.classList.remove('pressed');
            }, 100);
            
            const action = button.dataset.action;
            const number = button.dataset.number;
            
            if (number) {
                inputDigit(number);
            } else if (action === 'decimal') {
                inputDecimal();
            } else if (action === 'clear') {
                handleClear();
            } else if (action === 'sign') {
                toggleSign();
            } else if (action === 'percentage') {
                handlePercentage();
            } else if (['add', 'subtract', 'multiply', 'divide'].includes(action)) {
                handleOperator(action);
            } else if (action === 'equals') {
                handleEquals();
            } else if (action && action.startsWith('memory-')) {
                handleMemory(action);
            }
        }

        // Handle keyboard input
        function handleKeyboard(event) {
            const key = event.key;
            
            // Prevent default behavior for calculator keys
            if ('0123456789.+-*/=EnterEscapeBackspace%'.includes(key)) {
                event.preventDefault();
            }
            
            // Numbers
            if (key >= '0' && key <= '9') {
                const button = document.querySelector(`[data-number="${key}"]`);
                if (button) {
                    button.click();
                }
                return;
            }
            
            // Operators
            switch(key) {
                case '+':
                    document.querySelector('[data-action="add"]').click();
                    break;
                case '-':
                    document.querySelector('[data-action="subtract"]').click();
                    break;
                case '*':
                    document.querySelector('[data-action="multiply"]').click();
                    break;
                case '/':
                    document.querySelector('[data-action="divide"]').click();
                    break;
                case '=':
                case 'Enter':
                    document.querySelector('[data-action="equals"]').click();
                    break;
                case '.':
                    document.querySelector('[data-action="decimal"]').click();
                    break;
                case 'Escape':
                    document.querySelector('[data-action="clear"]').click();
                    break;
                case 'Backspace':
                    // Simulate clear entry
                    calculator.displayValue = calculator.displayValue.slice(0, -1) || '0';
                    updateDisplay();
                    break;
                case '%':
                    document.querySelector('[data-action="percentage"]').click();
                    break;
            }
        }

        // Initialize
        updateDisplay();
        
        // Event listeners
        document.querySelector('.keypad').addEventListener('click', handleButtonClick);
        document.querySelector('.memory-row').addEventListener('click', handleButtonClick);
        document.addEventListener('keydown', handleKeyboard);
        themeToggle.addEventListener('click', toggleTheme);
        
        // Touch feedback
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('touchstart', function() {
                this.style.opacity = '0.8';
            });
            
            button.addEventListener('touchend', function() {
                setTimeout(() => {
                    this.style.opacity = '1';
                }, 100);
            });
        });

        // Prevent context menu
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        // Handle button focus
        document.querySelectorAll('.key, .memory-btn').forEach(button => {
            button.addEventListener('focus', function() {
                this.style.outline = '2px solid #3498db';
                this.style.outlineOffset = '1px';
            });
            
            button.addEventListener('blur', function() {
                this.style.outline = 'none';
            });
        });
    </script>
</body>
</html>
